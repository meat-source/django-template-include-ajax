# django-template-include-ajax

Назначение: django-Тег, на подобии стандартного `{% include 'template.html' %}` для отложенной загрузки шаблона через 
ajax.При этом шаблон оборачивается в `<div>` Поддерживает, как внутренние так и внешние скрипты в шаблоне (через 
html-тег `<sсript>`). Имеет необязательное условие на 
минимальную и максимальную ширину экрана, при котором загружается шаблон. Они используется для отделения мобильной, 
десктопной и планшетной версий шаблона). Также имеет необязательный аргумент `delWrap`, 
который убирает обертку вокруг содержимого. По умолчанию отключен.(при включении не дает загрузится внешним скриптам).

Этот код не имеет смысла оборачивать в отдельное приложение django. Более целесообразно будет внедрить данный тег 
непосредственно в ваш проект.

зависимостей не имеет
 
## Работа
После загрузки в шаблоне тега `{% load template_include_ajax %}`
загружаем шаблон через ajax, где example.html имя шаблона 
```
{% include_ajax 'example.html' %}
```
если шаблон во вложенной папке, то указываем её
```
{% include_ajax 'folder/example.html' %}
```
также вы можете указать дополнительные параметры minWidth и maxWidth, за пределами которых ajax срабатывать не будет.
```
{% include_ajax 'example_only_tablet.html' minWidth='576' maxWidth='1025' %} 
```
Есть еще дополнительный параметр delWrap, который убирает обертку вокруг содержимого.По умолчанию отключен.
(при включении не дает загрузится внешним скриптам).
```
{% include_ajax 'example_not_wrap.html' delWrap='True' %}
```
### Установка
В вашем приложении создаем папку templatetags с файлом include_ajax. Далее в urls проекта добавляем
```
 path('include-ajax/<template>', include_ajax),
```

подключаем обработку в views

```
def include_ajax(request, template):
    template = template.replace('&', '/')  # для шаблонов вложенных в папку
    try:
        return render(request, template)
    except TemplateDoesNotExist:
        return HttpResponse(status=404)
```

в шаблоне подгружаем тег
```
{% load template_include_ajax %}
```
Все. Пользуемся.
## Важно:
1) рабочие скрипты после загрузки и исполнения самоудаляются ! (при проверке и отладке вы должны учитывать это)
2) внешние скрипты записываются в конец блока (т.е после данных)
3) ваш шаблон будет обернут в `<div>` вы можете убрать обертку использовав дополнительный параметр delWrap, но при этом 
не будут успевать срабатывать внешние скрипты (допустим яндекс карта).


## Запуск тестов

Протестировать работу можно скачав demo и подключив как обычный проект django


## Поспособствовать

Предложения, ошибки в работе и комментарии прошу отправлять на почту ukolovsl88@gmail.com

## Версии

Тестировалось на django 2.1.10 - 2.2.10, но скорее всего будет работать и в более ранних версиях.

## Автор

* **Вячеслав Уколов**  - [github.com/meat-source](https://github.com/meat-source)

## Лицензия

Этот проект лицензирован под лицензией MIT - [LICENSE.md](LICENSE.md)

